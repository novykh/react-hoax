<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: makeUseMember/index.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: makeUseMember/index.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { useCallback } from "react";
import useContextSelector from "../useContextSelector";
import identity from "lodash/identity";

/**
 * @description A hook that handles the mutate operations on a state's member.
 * @example
 * const [title, setTitle, error, setError] = useMember({
 *   fieldKey: 'title'
 * });
 *
 * setTitle('hello'); // state.title === 'hello'
 * setError('myError'); // state.errors.title === 'myError'
 */
const defaultGetUpdate = resourceId => state =>
  resourceId ? state.updateResource : state.update;

export default (StateCtx, DispatchCtx) => ({
  fieldKey,
  resourceId,
  getUpdate = defaultGetUpdate,
  select = identity
}) => {
  const selector = useCallback(
    state => {
      const member = resourceId ? select(resourceId)(state) : select(state);
      return [member[fieldKey], member.errors];
    },
    [resourceId, fieldKey]
  );
  const [value, errors] = useContextSelector(StateCtx, selector);

  const updateSelector = useCallback(
    state => {
      const update = getUpdate(resourceId)(state);

      if (typeof update !== "function")
        throw new Error("useMember expects an 'update' dispatch function");

      return resourceId ? (key, v) => update(resourceId, key, v) : update;
    },
    [resourceId]
  );
  const update = useContextSelector(DispatchCtx, updateSelector);

  const setValue = useCallback(v => update(fieldKey, v), [update, fieldKey]);

  const error = errors[fieldKey];
  const setError = useCallback(
    e => update("errors", { ...errors, [fieldKey]: e }),
    [update, errors]
  );

  return [value, setValue, error, setError];
};
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="collectionHoax.module_makeCollectionProvider.html">makeCollectionProvider</a></li><li><a href="memberHoax.module_makeMemberProvider.html">makeMemberProvider</a></li></ul><h3>Namespaces</h3><ul><li><a href="collectionHoax.html">collectionHoax</a></li><li><a href="memberHoax.html">memberHoax</a></li></ul><h3>Global</h3><ul><li><a href="global.html#defaultGetUpdate">defaultGetUpdate</a></li><li><a href="global.html#makeObserver">makeObserver</a></li><li><a href="global.html#makeWithUniq">makeWithUniq</a></li><li><a href="global.html#usePrevious">usePrevious</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Fri Nov 08 2019 16:21:31 GMT+0200 (Eastern European Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
